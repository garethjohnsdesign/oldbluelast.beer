{% extends "_layouts/site" %}

{% block main %}

<!-- Video Hero -->
<section class="home__hero">

  <div class="grid-y grid-padding-x height-100 align-center">
    <div class="shrink cell white">

      <div class="grid-container">
        <div class="grid-x align-right">
          <div class="small-12 medium-6 cell">
            <h6 class="sans-regular white padding-2">{{entry.heroText}}</h6>
          </div>
        </div>
      </div>

    </div>
  </div>

    <div class="show-for-small-only">
    {% set video = entry.heroVideoMobile.first() %}
    <video playsinline autoplay muted loop class="video" poster="">
      <source src="https://storage.googleapis.com/old-blue-last-beer/{{ video.filename }}" type="video/mp4">
    </video>
    </div>
  
    <div class="show-for-medium">
    {% set video = entry.heroVideo.first() %}
    <video playsinline autoplay muted loop class="video" poster="">
      <source src="https://storage.googleapis.com/old-blue-last-beer/{{ video.filename }}" type="video/mp4">
    </video>
    </div>


</section>
<!-- End Video Hero -->

<!-- Campaign -->
<div class="grid-x">
  <div class="small-12 cell">
  
    {% set image = entry.campaignImage.first() %}
    <div class="image--hero align-center-middle" data-interchange="{% include "_includes/images/interchange-img-small-12-medium-12-cell" %}">
      <div class="grid-y height-100 align-center">
        <div class="shrink cell text-center padding-2" id="video-gallery">


          <a href="https://www.youtube.com/watch?v=CciUPWG6Kp8" class="h1 white play_arrow"><svg class="icon icon-play_arrow"><use xlink:href="/assets/icons/symbol-defs.svg#icon-play_arrow"></use></svg></a>
        </div>
      </div>
    </div>
  
  </div>
</div>
<!-- End Campaign -->

<!-- Location -->
<section class="home__drink inverted padding-vertical-2" id="home__drink">
  <div class="grid-container">
    <div class="grid-x grid-padding-x grid-padding-y">
      <div class="small-12 cell text-uppercase">
        <h1>Drink</h1>
        <div><a href="/find-beer" class="h5 text-uppercase">Find Beer <svg class="icon icon-arrow_forward"><use xlink:href="/assets/icons/symbol-defs.svg#icon-arrow_forward"></use></svg></a></div>
      </div>
    </div>  
  </div>
</section>

{% set target = craft.request.getParam('near') %}
{% set coords = craft.smartMap.lookupCoords(target) %}

{% set sharedOptions = {
height: 600,
draggable: true,
center: coords,
markerInfo: '_includes/map/bubble',
markerOptions: {
icon: {
url: '/assets/images/can-small.png',
scaledSize: 'new google.maps.Size(32,32)'
}
},
infoWindowOptions: {
maxWidth: 200
}
} %}

{% if target %}
{% set params = {
target: target,
range: 20
} %}
{% set locations = craft.entries.section(['venues', 'shops']).address(params).order('distance').all() %}
{% set customOptions = {
center: coords,
zoom: 12,
} %}
{% else %}
{% set locations = craft.entries.section(['venues', 'shops']).all() %}

{% if currentSite.handle == 'uk' %}
{% set customOptions = {
center: {'lat':51.525114, 'lng':-0.079938},
zoom: 14,
} %}
{% elseif currentSite.handle == "usa" %}
{% set customOptions = {
center: {'lat':40.715525, 'lng':-73.965768},
zoom: 14,
} %}
{% else %}
{% set customOptions = {
center: {'lat':51.525114, 'lng':-0.079938},
zoom: 14,
} %}
{% endif %}


{% endif %}

{% set options = sharedOptions|merge(customOptions) %}

<div class="grid-x">
  <div class="small-12 cell">
    {{ craft.smartMap.map(locations, options) }}
  </div>
</div>

{# Loop through location entries #}

{% for entry in locations %}

    {#
      Perform custom logic
      to determine which icon
      will be assigned to each entry
    #}
    {% switch entry.locationType %}
        {% case 'venue' %}
            {% set icon = '/assets/images/can-small.png' %}
        {% case 'shop' %}
            {% set icon = '/assets/images/bag.png' %}
        {% default %}
            {% set icon = '/assets/images/can-small.png' %}
    {% endswitch %}

    {# JS: Change marker icon #}
    {% js %}

        var markerId = 'smartmap-mapcanvas-1.{{ entry.id }}.address';
        smartMap.marker[markerId].setOptions(
            {icon: {
                url: '{{ icon }}',
                scaledSize: new google.maps.Size(32,32)
            }}
        );

    {% endjs %}

{% endfor %}

{% js %}
$(function () {
        var styles = [
 {
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#f5f5f5"
     }
   ]
 },
 {
   "elementType": "geometry.stroke",
   "stylers": [
     {
       "color": "#242965"
     },
     {
       "saturation": 5
     },
     {
       "weight": 2
     }
   ]
 },
 {
   "elementType": "labels.icon",
   "stylers": [
     {
       "color": "#272a67"
     },
     {
       "visibility": "off"
     }
   ]
 },
 {
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#272a67"
     },
     {
       "saturation": -5
     }
   ]
 },
 {
   "elementType": "labels.text.stroke",
   "stylers": [
     {
       "saturation": -90
     }
   ]
 },
 {
   "featureType": "administrative.land_parcel",
   "elementType": "labels",
   "stylers": [
     {
       "visibility": "off"
     }
   ]
 },
 {
   "featureType": "administrative.land_parcel",
   "elementType": "labels.text",
   "stylers": [
     {
       "color": "#242965"
     }
   ]
 },
 {
   "featureType": "administrative.land_parcel",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#242965"
     }
   ]
 },
 {
   "featureType": "poi",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#eeeeee"
     }
   ]
 },
 {
   "featureType": "poi",
   "elementType": "labels.text",
   "stylers": [
     {
       "visibility": "off"
     }
   ]
 },
 {
   "featureType": "poi",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#757575"
     }
   ]
 },
 {
   "featureType": "poi.park",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#e5e5e5"
     }
   ]
 },
 {
   "featureType": "poi.park",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#9e9e9e"
     }
   ]
 },
 {
   "featureType": "road",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#ffffff"
     }
   ]
 },
 {
   "featureType": "road.arterial",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#757575"
     }
   ]
 },
 {
   "featureType": "road.highway",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#dadada"
     }
   ]
 },
 {
   "featureType": "road.highway",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#616161"
     }
   ]
 },
 {
   "featureType": "road.local",
   "elementType": "labels",
   "stylers": [
     {
       "visibility": "off"
     }
   ]
 },
 {
   "featureType": "road.local",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#9e9e9e"
     }
   ]
 },
 {
   "featureType": "transit.line",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#e5e5e5"
     }
   ]
 },
 {
   "featureType": "transit.station",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#eeeeee"
     }
   ]
 },
 {
   "featureType": "water",
   "elementType": "geometry",
   "stylers": [
     {
       "color": "#c9c9c9"
     }
   ]
 },
 {
   "featureType": "water",
   "elementType": "labels.text.fill",
   "stylers": [
     {
       "color": "#9e9e9e"
     }
   ]
 }
];
        smartMap.styleMap('smartmap-mapcanvas-1', styles);
    });
{% endjs %}

<!-- End Location -->

<!-- Get Some -->
<section class="home__get-some padding-vertical-3 inverted" id="home__get-some">
  <div class="grid-container">
    <div class="grid-x">
      <div class="small-12 medium-10 cell">
      <h1 class="text-uppercase">Get Some</h1>
      {{entry.getSomeText}}
      <div class="margin-top-1"><a href="http://eepurl.com/dbRQYD" class="h5 text-uppercase">Sign Up <svg class="icon icon-arrow_forward"><use xlink:href="/assets/icons/symbol-defs.svg#icon-arrow_forward"></use></svg></a></div>
      </div>
    </div>
  </div>
</section>
<!-- End Get Some -->

<!-- Party Video -->
<section class="home__party-video">
  {% if entry.partyVideo | length %}
    {% set video = entry.partyVideo.first() %}
    <video playsinline autoplay muted loop class="video" poster="">
      <source src="https://storage.googleapis.com/old-blue-last-beer/{{ video.filename }}" type="video/mp4">
    </video>
  {% endif %}
</section>
<!-- End Party Video -->

<!-- Party -->
<section class="home__party padding-vertical-3" id="home__party">
  <div class="grid-container">
    <div class="grid-x">
      <div class="small-12 medium-10 cell">
      <h1 class="text-uppercase">Party</h1>
      {{entry.partyText}}
      </div>
    </div>
  </div>
</section>
<!-- End Party -->

{# Upcoming Events #}

{% set entries = craft.entries
.section('events')
.eventDate('>' ~ now.getTimestamp())
.order('eventDate asc')
.all() %}

{% if entries|length %}
<section class="home__upcoming-events" id="home__events">

  <div class="grid-container">
    <div class="grid-x grid-padding-x grid-padding-y">
      <div class="small-12 cell text-uppercase">
        <h1>Upcoming Events</h1>  
      </div>
    </div>
  </div>

  <ul class="vertical menu home__upcoming-events__list">
  
  {% for entry in entries %}
    <li>
  	  <a href="{{ entry.eventFacebookLink}}" class="padding-left-0 padding-top-2 padding-bottom-1" target="_blank">
  	  
  	    <div class="grid-container">
          <div class="grid-x grid-padding-x">
          
            <div class="small-12 medium-8 cell text-uppercase">
              <h6>{{ entry.eventDate | date('D j M') }}</h6>
              <h5>{{ entry.title}} @ {% if entry.eventVenue|length %}{{ entry.eventVenue }},{% endif %} {{ entry.eventLocation }}</h5>
            </div>
            
            <div class="small-12 medium-4 cell text-uppercase text-left medium-text-right align-self-bottom margin-bottom-1">
              <span class="underline">Event Page</span>
            </div>
          
          </div>
        </div>
  	  
  	  </a>
    </li>
  {% endfor %}
  </ul>
  
</section>
{% endif %}
{# End Upcoming Events #}

{# Photos #}
<section class="home__photos inverted" id="home__photos">
    
    <div class="grid-container padding-vertical-2">
      <div class="grid-x grid-padding-x grid-padding-y">
        <div class="small-12 cell text-uppercase">
          <h1>Photos</h1>
          <div><a href="/photos" class="h5 text-uppercase">View All <svg class="icon icon-arrow_forward"><use xlink:href="/assets/icons/symbol-defs.svg#icon-arrow_forward"></use></svg></a></div>
        </div>
      </div>
    </div>
    
    <div class="grid-x small-up-1 medium-up-3 large-up-3">
      
        {% set evententries = craft.entries
        .section('events')
        .eventFeatured('1')
        .eventDate('<' ~ now.getTimestamp())
        .order('eventDate desc')
        .limit(9)
        .all() %}
        
        {% for entry in evententries %}
        <div class="cell">
          <div class="excerpt">
            <a href="{{ entry.url}}">
              
              <div class="grid-x excerpt__title align-middle">
                <div class="small-12 cell text-center padding-3">
                  <h5>{{ entry.title}}<br>@ {{ entry.eventVenue}}</h5>
                </div>
              </div>
              
              <div class="excerpt__image">
                {% for image in entry.eventThumb %}
                <div class="image--square" data-interchange="{% include "_includes/images/interchange-img-small-12-medium-6-cell" %}">
                  <div class="content"></div>
                </div>
                {% endfor %}
              </div>
            
            </a>
          </div>
        </div>
        {% endfor %}
        
    </div>
</section>

{# End Photos #}

<!-- The Beer -->
<section class="home__the-beer padding-vertical-3" id="home__the-beer">
  <div class="grid-container">
    <div class="grid-x">
      <div class="small-12 medium-10 cell">
      <h1 class="text-uppercase">The Beer</h1>
      {{entry.theBeerText}}
      </div>
    </div>
  </div>
</section>
<!-- End Party -->

<!-- Contact Form -->
<section class="home__the-beer padding-vertical-3" id="home__the-beer">
  <div class="grid-container">
    <div class="grid-x">
      <div class="small-12 medium-12 cell">
      <h1 class="text-uppercase">Contact</h1>
      {% include "_includes/contact/form" %}
      </div>
    </div>
  </div>
</section>
<!-- End Contact Form  -->


{% endblock %}